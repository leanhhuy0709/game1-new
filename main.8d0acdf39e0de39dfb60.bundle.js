(()=>{"use strict";class t{static init(e,s,i){t.canvas=document.getElementById(e),t.ctx=t.canvas.getContext("2d"),t.setSize(s,i),t.ctx&&(t.ctx.fillStyle="white",t.ctx.beginPath(),t.ctx.roundRect(0,0,s,i,0),t.ctx.closePath(),t.ctx.fill())}static setSize(e,s){t.canvas.width=e,t.canvas.height=s}}class e{constructor(e,s){console.log("Game Init"),t.init("game",e,s)}update(t){const e=Date.now();requestAnimationFrame((()=>this.update(e)))}start(){requestAnimationFrame((()=>this.update(Date.now())))}}class s{static getImage(t){return s.imageMap[t]||(s.imageMap[t]=new Image,s.imageMap[t].src=t),s.imageMap[t]}static loadAllImages(t){s.Length+=t.length;for(let e=0;e<t.length;e++)this.imageMap[t[e]]=new Image,this.imageMap[t[e]].src=t[e];for(let e=0;e<t.length;e++)this.imageMap[t[e]].onload=()=>{s.count++}}static isLoadComplete(){return s.count==s.Length}}s.imageMap={},s.audioMap={},s.count=1,s.Length=0;class i{constructor(t=0,e=0){this.x=t,this.y=e}getX(){return this.x}setX(t){this.x=t}getY(){return this.y}setY(t){this.y=t}setCoord(t,e){this.x=t,this.y=e}static distance(t,e,s,i){return Math.sqrt((t-s)*(t-s)+(e-i)*(e-i))}}class n{constructor(t,e,s){this.magnitude=t,this.direction=new i(e,s),this.setUpDirection()}getMagnitude(){return this.magnitude}getDirection(){return this.direction}setMagnitude(t){this.magnitude=t}setDirection(t,e){this.direction.setCoord(t,e),this.setUpDirection()}getMagnitudeX(){return this.magnitude*this.direction.getX()}getMagnitudeY(){return this.magnitude*this.direction.getY()}setUpDirection(){const t=this.direction.getX(),e=this.direction.getY(),s=Math.sqrt(t*t+e*e);0==s?(this.direction=new i(0,0),this.magnitude=0):this.direction.setCoord(t/s,e/s)}}class o{constructor(t=0,e=1,s=0){this.position=new i(0,0),this.velocity=new n(t,e,s)}update(t){this.position.setCoord(this.position.getX()+t*this.velocity.getMagnitudeX(),this.position.getY()+t*this.velocity.getMagnitudeY())}getSpeed(){return this.velocity.getMagnitude()}getX(){return this.position.getX()}getY(){return this.position.getY()}setSpeed(t){this.velocity.setMagnitude(t)}}class h{constructor(t){this.parent=t}update(t){}}class a extends h{constructor(t,e){super(t),this.depth=e,this.isActive=!0}render(t=new o){}setDepth(t){this.depth=t}getDepth(){return this.depth}getIsActive(){return this.isActive}setIsAcitve(t){this.isActive=t}}class r extends a{constructor(t,e,i=1){super(t,i),this.image=s.getImage(e)}getBackground(){return this.image}render(e=new o){var s;if(!this.isActive)return;const i=t.canvas.width,n=t.canvas.height;let h=this.parent.getX()-e.getX(),a=this.parent.getY()-e.getY();for(h+this.parent.getWidth()<0&&(h+=this.parent.getWidth()),a+this.parent.getHeight()<0&&(a+=this.parent.getHeight());h<i;){for(;a<n;)null===(s=t.ctx)||void 0===s||s.drawImage(this.image,h,a,this.parent.getWidth(),this.parent.getHeight()),a+=this.parent.getHeight();a=this.parent.getY()-e.getY(),a+this.parent.getHeight()<0&&(a+=this.parent.getHeight()),h+=this.parent.getWidth()}}update(t){}}class c{constructor(t,e){this.width=t,this.height=e}getWidth(){return this.width}getHeight(){return this.height}setWidth(t){this.width=t}setHeight(t){this.height=t}setSize(t,e){this.width=t,this.height=e}}class g{constructor(t,e,s,n){this.coord=new i(t,e),this.size=new c(s,n),this.components=[]}getX(){return this.coord.getX()}getY(){return this.coord.getY()}setX(t){this.coord.setX(t)}setY(t){this.coord.setY(t)}getWidth(){return this.size.getWidth()}getHeight(){return this.size.getHeight()}setWidth(t){this.size.setWidth(t)}setHeight(t){this.size.setHeight(t)}addComponent(t){this.components.push(t)}update(t){for(let e=0;e<this.components.length;e++)this.components[e].update(t)}render(){for(let t=0;t<this.components.length;t++)this.components[t]instanceof a&&this.components[t].render()}getComponent(t){return this.components.filter((e=>e instanceof t))}getComponents(){return this.components}}class d extends a{constructor(t,e=1,s="",i="30px Cambria",n="center",o="black",h="alphabetic"){super(t,e),this.content=s,this.font=i,this.align=n,this.color=o,this.baseline=h}getContent(){return this.content}getFont(){return this.font}getAlign(){return this.align}setContent(t){this.content=t}setFont(t){this.font=t}setAlign(t){this.align=t}render(){t.ctx&&(t.ctx.fillStyle=this.color,t.ctx.font=this.font,t.ctx.textAlign=this.align,t.ctx.textBaseline=this.baseline,t.ctx.fillText(this.content,this.parent.getX(),this.parent.getY()))}setColor(t){this.color=t}getColor(){return this.color}}class u extends a{constructor(t,e=1,s=""){super(t,e),this.text=new d(new g(t.getX()+t.getWidth()/2,t.getY()+t.getHeight()/2,0,0),e,s,"30px 'Montserrat', sans-serif","center","white","middle"),this.isHover=!1}getText(){return this.text}setContent(t){this.text.setContent(t)}render(e=new o){super.render(),t.ctx&&(t.ctx.beginPath(),t.ctx.fillStyle=this.isHover?"#ffffff":"#0d63fd",t.ctx.roundRect(this.parent.getX()-e.getX(),this.parent.getY()-e.getY(),this.parent.getWidth(),this.parent.getHeight(),10),t.ctx.closePath(),t.ctx.fill(),this.text.setColor(this.isHover?"#0d63fd":"#ffffff"),this.text.render())}isClicked(t,e){return t>=this.parent.getX()&&t<=this.parent.getX()+this.parent.getWidth()&&e>=this.parent.getY()&&e<=this.parent.getY()+this.parent.getHeight()}isHovered(t,e){return this.isHover=t>=this.parent.getX()&&t<=this.parent.getX()+this.parent.getWidth()&&e>=this.parent.getY()&&e<=this.parent.getY()+this.parent.getHeight(),this.isHover}}class l extends h{constructor(t){super(t)}}class p extends h{constructor(t,e=0,s=0,i=0){super(t),this.velocity=new n(e,s,i)}update(t){const e=this.velocity.getMagnitudeX(),s=this.velocity.getMagnitudeY(),i=this.parent.getX()+e*t,n=this.parent.getY()+s*t;this.parent.setX(i),this.parent.setY(n)}getVelocity(){return this.velocity}setVelocity(t,e,s){this.velocity.setMagnitude(t),this.velocity.setDirection(e,s)}addVeloctity(t,e,s){const i=this.velocity.getMagnitudeX()+t*e,n=this.velocity.getMagnitudeY()+t*s,o=Math.sqrt(Math.pow(i,2)+Math.pow(n,2));0==o?(this.velocity.setMagnitude(0),this.velocity.setDirection(0,0)):(this.velocity.setDirection(i/o,n/o),this.velocity.setMagnitude(o))}}class m{static checkCollision(t,e){const s=t.getComponent(l),i=e.getComponent(l);if(0==s.length||0==i.length)return!1;const n=t.getX(),o=t.getY(),h=e.getX(),a=e.getY(),r=t.getWidth(),c=t.getHeight(),g=e.getWidth(),d=e.getHeight();return n+r>=h&&n<=h+g&&o+c>=a&&o<=a+d&&(m.resolveCollision(t,e),!0)}static resolveCollision(t,e){const s=t.getX(),i=t.getY(),n=e.getX(),o=e.getY(),h=t.getWidth(),a=t.getHeight(),r=e.getWidth(),c=e.getHeight(),g=t.getComponent(p),d=e.getComponent(p);let u,l;u=g.length>0?g[0]:null,l=d.length>0?d[0]:null;const m=n+r-(s+h),C=o+c-(i+a);let M=Math.abs(m)>Math.abs(C);const x=M;if(M){if(u){const t=u.getVelocity().getDirection().getY();i<o?t<0&&(M=!x):i>o&&t>0&&(M=!x)}else if(l){const t=l.getVelocity().getDirection().getY();i<o?t>0&&(M=!x):i>o&&t<0&&(M=!x)}}else if(u){const t=u.getVelocity().getDirection().getX();s<n?t<0&&(M=!x):s>n&&t>0&&(M=!x)}else if(l){const t=l.getVelocity().getDirection().getX();s<n?t>0&&(M=!x):s>n&&t<0&&(M=!x)}if(M){if(u&&u.setVelocity(u.getVelocity().getMagnitudeX(),u.getVelocity().getDirection().getX(),0),l&&l.setVelocity(l.getVelocity().getMagnitudeX(),l.getVelocity().getDirection().getX(),0),i<o){const s=i+a-o;let n=-s/2,h=s/2;u||(n=0,h*=2),l||(n*=2,h=0),t.setY(i+n),e.setY(o+h)}else if(i>o){const s=o+c-i;let n=+s/2,h=-s/2;u||(n=0,h*=2),l||(n*=2,h=0),t.setY(i+n),e.setY(o+h)}}else if(u&&u.setVelocity(u.getVelocity().getMagnitudeY(),0,u.getVelocity().getDirection().getY()),l&&l.setVelocity(l.getVelocity().getMagnitudeY(),0,l.getVelocity().getDirection().getY()),s<n){const i=s+h-n;let o=-i/2,a=i/2;u||(o=0,a*=2),l||(o*=2,a=0),t.setX(s+o),e.setX(n+a)}else if(s>n){const i=n+r-s;let o=i/2,h=-i/2;u||(o=0,h*=2),l||(o*=2,h=0),t.setX(s+o),e.setX(n+h)}}}const C=class{constructor(e,s,n=0){this.input=new class{constructor(){this.keyStatesDown={},this.keyStatesUp={},this.checkMouseDown=!1,this.coord=new i(0,0),this.coordHover=new i(0,0),this.coordTouch=new i(-1,-1),this.directTouch="",document.addEventListener("keydown",this.handleKeyDown.bind(this)),document.addEventListener("keyup",this.handleKeyUp.bind(this)),t.canvas.addEventListener("mousedown",this.handleMouseDown.bind(this)),t.canvas.addEventListener("mouseup",this.handleMouseUp.bind(this)),t.canvas.addEventListener("mousemove",this.handleMouseMove.bind(this)),t.canvas.addEventListener("touchstart",this.handleTouchStart.bind(this)),t.canvas.addEventListener("touchend",this.handleTouchEnd.bind(this))}handleKeyDown(t){this.keyStatesDown[t.code]=!0,this.keyStatesUp[t.code]=!1}handleKeyUp(t){this.keyStatesDown[t.code]=!1,this.keyStatesUp[t.code]=!0}handleMouseDown(e){const s=t.canvas.getBoundingClientRect(),i=e.clientX-s.left,n=e.clientY-s.top;this.checkMouseDown=!0,this.coord.setCoord(i,n)}handleMouseUp(t){this.checkMouseDown=!1,this.coord.setCoord(0,0)}handleMouseMove(e){const s=t.canvas.getBoundingClientRect(),i=e.clientX-s.left,n=e.clientY-s.top;this.coordHover.setCoord(i,n)}handleTouchStart(e){const s=t.canvas.getBoundingClientRect(),i=e.touches[0],n=i.clientX-s.left,o=i.clientY-s.top;this.coordTouch.setCoord(n,o)}handleTouchEnd(e){const s=t.canvas.getBoundingClientRect(),i=e.changedTouches[0],n=i.clientX-s.left,o=i.clientY-s.top,h=this.getDirection(this.coordTouch.getX(),this.coordTouch.getY(),n,o);this.directTouch=h}resetTouch(){this.coordTouch.setCoord(-1,-1),this.directTouch=""}getDirection(t,e,s,i){const n=s-t,o=i-e;return n<0&&o<0?Math.abs(n)<Math.abs(o)?"U":"L":n<0&&o>0?Math.abs(n)<Math.abs(o)?"D":"L":n>0&&o<0?Math.abs(n)<Math.abs(o)?"U":"R":n>0&&o>0?Math.abs(n)<Math.abs(o)?"D":"R":"N"}isKeyDown(t){return this.keyStatesDown[t]}isKeyUp(t){return this.keyStatesUp[t]}isMouseDown(){return this.checkMouseDown}isMouseUp(){return!this.checkMouseDown}getMouseCoord(){return this.coord}getMouseHoverCoord(){return this.coordHover}isTouchDown(){return""!=this.directTouch}getDirectTouch(){return this.directTouch}getTouchCoord(){return this.coordTouch}resetAllKeyEvent(){this.keyStatesDown={},this.keyStatesUp={}}resetKeyEvent(t){this.keyStatesDown[t]=!1,this.keyStatesUp[t]=!1}},this.name=s,this.renderer=new class{constructor(){this.renders=[]}addToQueue(t){const e=t.getComponents();for(let t=0;t<e.length;t++)e[t]instanceof a&&this.renders.push(e[t])}sortQueue(){this.renders.sort(((t,e)=>t.getDepth()-e.getDepth()))}renderAll(t=new o){this.sortQueue();for(let e=0;e<this.renders.length;e++)this.renders[e].render(t)}},this.gameObjects=[],this.sceneManager=e,this.camera=new o(n)}update(t){this.camera.update(t);for(let e=0;e<this.gameObjects.length;e++)this.gameObjects[e].update(t);for(let t=0;t+1<this.gameObjects.length;t++)for(let e=t+1;e<this.gameObjects.length;e++){const s=this.gameObjects[t],i=this.gameObjects[e];m.checkCollision(s,i)}}render(){this.renderer.renderAll(this.camera)}clear(){}getName(){return this.name}addObject(t){this.gameObjects.push(t),this.renderer.addToQueue(t)}getCamera(){return this.camera}setCameraSpeed(t){this.camera.setSpeed(t)}};class M{static getScore(){return this.score}static getHighScore(){return this.highScore}static addWithDeltaTime(t,e){M.score+=t*e,M.highScore=this.highScore>this.score?this.highScore:this.score}static add(t){this.score+=t,this.highScore=this.highScore>this.score?this.highScore:this.score}static resetScore(){this.score=0}static resetHighScore(){this.highScore=0}static setLevel(t){this.level=t}static getLevel(){return this.level}static resetLevel(){this.level=1}}M.score=0,M.highScore=0,M.level=1;const x="assets/fly-dinosaur/3.png",w="assets/fly-dinosaur/4.png",S="assets/fly-dinosaur/5.png",b="assets/Cactus/Cactus.png",v="assets/background/4.png",D="assets/background/1.png",B="assets/background/parallax_backgound_pack/ground.png",f="assets/background/parallax_backgound_pack/2.png",O="assets/background/5.png",y="assets/background/5.png",X="assets/dinosaur-sprites/Run (1).png",T="assets/dinosaur-sprites/Run (2).png",Y="assets/dinosaur-sprites/Run (3).png",H="assets/dinosaur-sprites/Run (4).png",E="assets/dinosaur-sprites/Run (5).png",I="assets/dinosaur-sprites/Run (6).png",k="assets/dinosaur-sprites/Run (7).png",j="assets/dinosaur-sprites/Run (8).png",A="assets/dinosaur-sprites/Jump (1).png",N="assets/dinosaur-sprites/Jump (2).png",G="assets/dinosaur-sprites/Jump (3).png",U="assets/dinosaur-sprites/Jump (4).png",_="assets/dinosaur-sprites/Jump (5).png",J="assets/dinosaur-sprites/Jump (6).png",R="assets/dinosaur-sprites/Jump (7).png",V="assets/dinosaur-sprites/Jump (8).png",W="assets/dinosaur-sprites/Jump (9).png",L="assets/dinosaur-sprites/Jump (10).png",K="assets/dinosaur-sprites/Jump (11).png",P="assets/dinosaur-sprites/Jump (12).png",F="assets/dinosaur-sprites/Duck (1).png",$="assets/dinosaur-sprites/Duck (2).png",z="assets/background/cloud1.webp";var q;!function(t){t[t.BACKGROUND_LOWEST=1]="BACKGROUND_LOWEST",t[t.BACKGROUND_LOW=2]="BACKGROUND_LOW",t[t.BACKGROUND_MEDIUM=3]="BACKGROUND_MEDIUM",t[t.BACKGROUND_HIGH=4]="BACKGROUND_HIGH",t[t.BACKGROUND_HIGHEST=5]="BACKGROUND_HIGHEST",t[t.OBJECT_LOWEST=6]="OBJECT_LOWEST",t[t.OBJECT_LOW=7]="OBJECT_LOW",t[t.OBJECT_MEDIUM=8]="OBJECT_MEDIUM",t[t.OBJECT_HIGH=9]="OBJECT_HIGH",t[t.OBJECT_HIGHEST=10]="OBJECT_HIGHEST"}(q||(q={}));class Q extends C{constructor(t,e=0){super(t,"GameOverScene",e),this.textBox=new g(350,120,0,0),this.textBox.addComponent(new d(this.textBox,q.OBJECT_MEDIUM,"Game Over","50px Comic Sans MS","center","#713B61")),this.addObject(this.textBox),this.bg=new g(0,0,700,400),this.bg.addComponent(new r(this.bg,v,q.BACKGROUND_MEDIUM)),this.addObject(this.bg),this.tryAgainBtn=new g(250,195,200,50),this.tryAgainBtn.addComponent(new u(this.tryAgainBtn,q.OBJECT_MEDIUM,"Try again")),this.addObject(this.tryAgainBtn),this.settingBtn=new g(250,255,200,50),this.settingBtn.addComponent(new u(this.settingBtn,q.OBJECT_MEDIUM,"Setting")),this.addObject(this.settingBtn),this.exitBtn=new g(250,315,200,50),this.exitBtn.addComponent(new u(this.exitBtn,q.OBJECT_MEDIUM,"Exit")),this.addObject(this.exitBtn),this.scoreText=new g(10,30,100,100),this.scoreText.addComponent(new d(this.scoreText,q.OBJECT_LOW,`${Math.floor(M.getScore())}`,"30px Comic Sans MS","start","#000000")),this.addObject(this.scoreText),this.highScoreText=new g(700,30,100,100),this.highScoreText.addComponent(new d(this.highScoreText,q.OBJECT_LOW,`${Math.floor(M.getHighScore())}`,"30px Comic Sans MS","end","#000000")),this.addObject(this.highScoreText)}update(t){const e=this.input.getMouseHoverCoord(),s=e.getX()-this.getCamera().getX(),i=e.getY()-this.getCamera().getY(),n=this.tryAgainBtn.getComponent(u)[0],o=this.settingBtn.getComponent(u)[0],h=this.exitBtn.getComponent(u)[0];if(n.isHovered(s,i),o.isHovered(s,i),h.isHovered(s,i),this.input.isMouseDown()){const t=this.input.getMouseCoord();n.isClicked(t.getX(),t.getY())?this.sceneManager.setNextScene("GamePlayScene"):o.isClicked(t.getX(),t.getY())?this.sceneManager.setNextScene("GameSettingScene"):h.isClicked(t.getX(),t.getY())&&this.sceneManager.setNextScene("GameStartScene")}else if(this.input.isTouchDown()){const t=this.input.getTouchCoord();n.isClicked(t.getX(),t.getY())?this.sceneManager.setNextScene("GamePlayScene"):o.isClicked(t.getX(),t.getY())?this.sceneManager.setNextScene("GameSettingScene"):h.isClicked(t.getX(),t.getY())&&this.sceneManager.setNextScene("GameStartScene"),this.input.resetTouch()}super.update(t)}}const Z=class extends a{constructor(t,e,i=1){super(t,i),this.image=s.getImage(e)}getPicture(){return this.image}render(e=new o){var s;this.isActive&&(null===(s=t.ctx)||void 0===s||s.drawImage(this.image,this.parent.getX()-e.getX(),this.parent.getY()-e.getY(),this.parent.getWidth(),this.parent.getHeight()))}update(t){}},tt=class extends g{constructor(t,e,s,i){super(t,e,s,i),this.addComponent(new l(this))}reset(t){}};class et{constructor(t,e,s){this.forceVector=new n(t,e,s)}getForceVector(){return this.forceVector}static calculateTotalForce(t){let e=0,s=0;for(const i of t)e+=i.forceVector.getMagnitudeX(),s+=i.forceVector.getMagnitudeY();const i=Math.sqrt(Math.pow(e,2)+Math.pow(s,2));return 0==i?new et(0,0,0):new et(i,e/i,s/i)}}const st=new et(.015,0,1);class it extends p{constructor(t,e=0,s=0,i=0){super(t,e,s,i),this.forces=[st],this.acceleration=new n(0,0,0),this.calculateAcceleration()}addForce(t){this.forces.push(t),this.calculateAcceleration()}calculateAcceleration(){const t=et.calculateTotalForce(this.forces);this.acceleration.setMagnitude(t.getForceVector().getMagnitude()/1),this.acceleration.setDirection(t.getForceVector().getDirection().getX(),t.getForceVector().getDirection().getY()),this.forces=[t]}update(t){const e=this.velocity.getMagnitudeX(),s=this.velocity.getMagnitudeY(),i=e+this.acceleration.getMagnitudeX(),n=s+this.acceleration.getMagnitudeY(),o=(e+i)/2,h=(s+n)/2,a=this.parent.getX()+o*t,r=this.parent.getY()+h*t;this.parent.setX(a),this.parent.setY(r),this.velocity.setMagnitude(Math.sqrt(Math.pow(i,2)+Math.pow(n,2))),this.velocity.setDirection(i,n)}getAcceleration(){return this.acceleration}setAcceleration(t,e,s){this.acceleration.setMagnitude(t),this.acceleration.setDirection(e,s)}}class nt extends tt{constructor(t){super(t,0,0,0),this.addComponent(new Z(this,b,q.OBJECT_MEDIUM)),this.addComponent(new it(this,0,0,0)),this.reset(t)}reset(t){this.setX(t),this.setY(100),this.setWidth(60),this.setHeight(80)}}const ot=class extends a{constructor(t,e=[],i=1,n=1){super(t,n),this.images=[];for(let t=0;t<e.length;t++)this.images.push(s.getImage(e[t]));this.idx=0,this.delay=0,this.spriteChangeInterval=i}getCurrent(){return this.images[this.idx]}goToNext(t){this.delay+=t,this.delay>this.spriteChangeInterval&&(this.idx++,this.delay=0),this.idx%=this.images.length}setIdx(t){this.idx=t%this.images.length}getLength(){return this.images.length}getIdx(){return this.idx}render(e=new o){var s;this.isActive&&(null===(s=t.ctx)||void 0===s||s.drawImage(this.getCurrent(),this.parent.getX()-e.getX(),this.parent.getY()-e.getY(),this.parent.getWidth(),this.parent.getHeight()))}setDelay(t){this.delay=t}update(t){this.goToNext(t)}};class ht{static getIntNumber(t,e){return Math.floor(Math.random()*(e-t)+t)}static getNumber(t,e){return Math.random()*(e-t)+t}static shuffle(t){t.sort(((t,e)=>Math.random()))}}class at extends tt{constructor(t){super(t,0,0,0),this.addComponent(new ot(this,[x,w,S],27,q.OBJECT_MEDIUM)),this.addComponent(new p(this,0,0,0)),this.addComponent(new l(this)),this.reset(t)}reset(t,e=.1){this.setX(t);const s=[80,50];this.setY(s[ht.getIntNumber(0,s.length)]),this.setWidth(90),this.setHeight(80);const i=this.getComponent(p);i.length>0&&i[0].setVelocity(e,-1,0)}}class rt{constructor(){this.obstacles=[]}reset(t){let e=1e3;for(let t=0;t<this.obstacles.length;t++){e=Math.floor(1e3*Math.random())+400+e;const s=this.obstacles[t].getComponent(p)[0].getVelocity().getMagnitudeX();this.obstacles[t].reset(e+100*s)}}update(t,e=new o){const s=[];for(let i=0;i<this.obstacles.length;i++)this.obstacles[i].getX()<=e.getX()+700&&this.obstacles[i].update(t),this.obstacles[i].getX()+this.obstacles[i].getWidth()<e.getX()&&s.push(i);let i=0;for(let t=0;t<this.obstacles.length;t++)i=i>this.obstacles[t].getX()?i:this.obstacles[t].getX();for(let t=0,e=0;t<s.length;t++)e=s[t],i+=Math.floor(1e3*Math.random())+400,this.obstacles[e].reset(i)}render(){for(let t=0;t<this.obstacles.length;t++)this.obstacles[t].render()}checkCollision(t){for(let e=0;e<this.obstacles.length;e++)if(m.checkCollision(this.obstacles[e],t))return!0;return!1}getObstacles(){return this.obstacles}add(t){this.obstacles.push(t)}}class ct extends ot{constructor(t,e,s,i=1){super(t,e,s,i)}goToNext(t){this.delay+=t,this.delay>this.spriteChangeInterval&&(this.idx++,this.delay=0),this.idx>this.images.length&&(this.idx=this.images.length-1)}setIdx(t){this.idx=t,this.idx>this.images.length&&(this.idx=this.images.length-1),this.idx=this.images.length-1}}class gt{constructor(t){this.audio=new Audio(t)}play(){gt.canPlaySound&&(this.audio.volume=gt.volume,this.audio.play())}pause(){this.audio.pause()}stop(){this.audio.pause(),this.audio.currentTime=0}static setVolume(t){(t/=100)>1?t=1:t<0&&(t=0),gt.volume=t}isPlaying(){return!this.audio.paused&&!this.audio.ended}static getVolume(){return 100*gt.volume}static setCanPlay(){gt.canPlaySound=!0}}gt.volume=.5,gt.canPlaySound=!1;const dt=gt,ut=class extends g{constructor(t=0,e=0,s=0,i=0,n=1){super(t,e,s,i),this.addComponent(new it(this,n,1,0)),this.addComponent(new l(this)),this.addComponent(new ot(this,[X,T,Y,H,E,I,k,j],10,q.OBJECT_HIGH)),this.addComponent(new ct(this,[A,N,G,U,_,J,R,V],20,q.OBJECT_HIGH)),this.addComponent(new ct(this,[V,V,W,L,K,P],20,q.OBJECT_HIGH)),this.addComponent(new ot(this,[F,$],10,q.OBJECT_HIGH)),this.minJump=0,this.checkMinJump=!1,this.defaultSpeed=n,this.jumpSfx=new dt("assets/sound/jump_sfx.mp3"),this.fallSfx=new dt("assets/sound/fall_sfx.wav")}update(t){super.update(t);const e=this.getComponent(ot),s=e[0],i=e[1],n=e[2],o=e[3],h=this.getComponent(it)[0];this.isDuck?(s.setIsAcitve(!1),o.setIsAcitve(!0),i.setIsAcitve(!1),n.setIsAcitve(!1)):Math.abs(h.getVelocity().getMagnitudeY())<.05?(s.setIsAcitve(!0),o.setIsAcitve(!1),i.setIsAcitve(!1),n.setIsAcitve(!1)):h.getVelocity().getMagnitudeY()<0?(s.setIsAcitve(!1),o.setIsAcitve(!1),i.setIdx(0),i.setIsAcitve(!0),n.setIsAcitve(!1)):h.getVelocity().getMagnitudeY()>0&&(s.setIsAcitve(!1),o.setIsAcitve(!1),i.setIsAcitve(!1),n.setIdx(0),n.setIsAcitve(!0)),this.checkMinJump&&(this.minJump+=1.5*t)}jump(){this.isDuck&&this.move();const t=this.getComponent(it)[0];0==Math.abs(t.getVelocity().getMagnitudeY())&&(this.minJump=0,this.checkMinJump=!0,t.addVeloctity(3,0,-1),this.jumpSfx.stop(),this.jumpSfx.play()),this.getY()<=0&&this.fall()}fall(){this.isDuck&&this.move();const t=this.getComponent(it)[0];t.getVelocity().getMagnitudeY()<0&&t.setVelocity(this.defaultSpeed,1,0)}duck(){const t=this.getComponent(it)[0];0==Math.abs(t.getVelocity().getMagnitudeY())&&(this.isDuck=!0,this.setHeight(80),this.setY(270))}move(){const t=this.getComponent(it)[0];0==Math.abs(t.getVelocity().getMagnitudeY())&&(this.isDuck=!1,this.setHeight(100),this.setY(250))}getMinJump(){return this.minJump}getDefaultSpeed(){return this.defaultSpeed}setDefaultSpeed(t){this.defaultSpeed=t}};class lt{constructor(){this.objs=[]}reset(){let t=0;for(let e=0;e<this.objs.length;e++)t=Math.floor(500*Math.random())+300+t,this.objs[e].reset(t)}render(){for(let t=0;t<10;t++)this.objs[t].render()}update(t,e){const s=[];for(let i=0;i<this.objs.length;i++)this.objs[i].update(t),this.objs[i].getX()+this.objs[i].getWidth()<e.getX()&&s.push(i);let i=0;for(let t=0;t<this.objs.length;t++)i=i>this.objs[t].getX()?i:this.objs[t].getX();for(let t=0,e=0;t<s.length;t++)e=s[t],i+=Math.floor(500*Math.random())+300,this.objs[e].reset(i)}getDecors(){return this.objs}addDecor(t){this.objs.push(t)}}class pt extends g{constructor(t,e,s,i){super(t,e,s,i)}reset(t){}}class mt extends pt{constructor(t,e,s,i,n=q.OBJECT_LOW){super(t,e,s,i),this.addComponent(new Z(this,z,n)),this.addComponent(new p(this,0,0,0)),this.reset(t)}reset(t){this.setX(t),this.setY(ht.getIntNumber(0,140)),this.setWidth(90),this.setHeight(80);const e=this.getComponent(p);e.length>0&&e[0].setVelocity(ht.getIntNumber(-5,5)/10,-1,0)}}const Ct=class extends C{constructor(t){super(t,"GamePlayScene",1.8),this.tRex=new ut(0,100,100,100,1.8),this.addObject(this.tRex),this.bg=new g(0,0,1e3,400),this.bg.addComponent(new r(this.bg,D,q.BACKGROUND_MEDIUM)),this.addObject(this.bg),this.ground1=new g(0,350,4e3,100),this.ground1.addComponent(new Z(this.ground1,B,q.BACKGROUND_HIGH)),this.ground1.addComponent(new l(this.ground1)),this.addObject(this.ground1);const e=new nt(100),s=new nt(100),i=new nt(100),n=new nt(100),o=new at(100),h=new at(100);this.obstacleManager=new rt,this.obstacleManager.add(e),this.obstacleManager.add(s),this.obstacleManager.add(i),this.obstacleManager.add(n),this.obstacleManager.add(o),this.obstacleManager.add(h),this.obstacleManager.reset(this.camera),this.addObject(e),this.addObject(s),this.addObject(i),this.addObject(n),this.addObject(o),this.addObject(h),this.moutain=new g(0,0,1e3,400),this.moutain.addComponent(new r(this.moutain,f,q.BACKGROUND_MEDIUM)),this.moutain.addComponent(new p(this.moutain,.1,-1,0)),this.addObject(this.moutain);const a=new g(10,30,100,100);a.addComponent(new d(a,q.OBJECT_LOW,`${M.getScore()}`,"30px Comic Sans MS","start","#000000")),this.addObject(a),this.scoreText=a;const c=new g(700,30,100,100);c.addComponent(new d(c,q.OBJECT_LOW,`${M.getHighScore()}`,"30px Comic Sans MS","end","#000000")),this.addObject(c),this.highScoreText=c,this.ground2=new g(4e3,300,4e3,100),this.ground2.addComponent(new Z(this.ground2,B,q.BACKGROUND_HIGH)),this.ground2.addComponent(new l(this.ground2)),this.addObject(this.ground2),this.ground3=new g(8e3,325,4e3,100),this.ground3.addComponent(new Z(this.ground3,B,q.BACKGROUND_HIGH)),this.ground3.addComponent(new l(this.ground3)),this.addObject(this.ground3),dt.setCanPlay(),this.sound=new dt("assets/sound/music1.mp3"),this.sound.play(),this.decorManager=new lt;const u=new mt(500,100,90,80),m=new mt(600,100,90,80),C=new mt(700,100,90,80),x=new mt(800,100,90,80),w=new mt(900,100,90,80);this.addObject(u),this.addObject(m),this.addObject(C),this.addObject(x),this.addObject(w),this.decorManager.addDecor(u),this.decorManager.addDecor(m),this.decorManager.addDecor(C),this.decorManager.addDecor(x),this.decorManager.addDecor(w),M.resetScore(),M.resetLevel()}update(t){this.ground1.getX()+this.ground1.getWidth()<=this.getCamera().getX()?this.ground1.setX(this.ground3.getX()+this.ground3.getWidth()):this.ground2.getX()+this.ground2.getWidth()<=this.getCamera().getX()?this.ground2.setX(this.ground1.getX()+this.ground1.getWidth()):this.ground3.getX()+this.ground3.getWidth()<=this.getCamera().getX()&&this.ground3.setX(this.ground2.getX()+this.ground2.getWidth()),this.obstacleManager.update(t,this.getCamera()),this.decorManager.update(t,this.getCamera()),this.input.isKeyDown("Space")?this.tRex.jump():this.input.isKeyUp("Space")&&this.tRex.getMinJump()>=90&&(this.tRex.fall(),this.input.resetAllKeyEvent()),this.input.isKeyDown("ArrowDown")?this.tRex.duck():this.input.isKeyUp("ArrowDown")&&this.tRex.move(),this.obstacleManager.update(t,this.getCamera()),this.obstacleManager.checkCollision(this.tRex)&&this.sceneManager.setNextScene("GameOverScene"),this.scoreText.getComponent(d)[0].setContent(`${Math.floor(M.getScore())}`),this.highScoreText.getComponent(d)[0].setContent(`${Math.floor(M.getHighScore())}`),M.addWithDeltaTime(t,.1),M.getScore()>1e3*M.getLevel()&&(this.tRex.getComponent(p)[0].addVeloctity(.5,1,0),this.tRex.setDefaultSpeed(this.tRex.getDefaultSpeed()+.5),M.setLevel(M.getLevel()+1),this.getCamera().setSpeed(this.getCamera().getSpeed()+.5)),super.update(t),m.checkCollision(this.tRex,this.ground1)&&this.tRex.getX()<this.ground1.getX()&&this.sceneManager.setNextScene("GameOverScene"),m.checkCollision(this.tRex,this.ground2)&&this.tRex.getX()<this.ground2.getX()&&this.sceneManager.setNextScene("GameOverScene"),m.checkCollision(this.tRex,this.ground3)&&this.tRex.getX()<this.ground3.getX()&&this.sceneManager.setNextScene("GameOverScene")}clear(){super.clear(),this.sound.stop()}render(){super.render()}};class Mt extends C{constructor(t,e=0){super(t,"GameSettingScene",e),this.tRex=new ut(0,0,100,100,0),this.addObject(this.tRex),this.textBox=new g(350,120,0,0),this.textBox.addComponent(new d(this.textBox,q.OBJECT_MEDIUM,"T-Rex Jump","50px Comic Sans MS","center","#713B61")),this.addObject(this.textBox),this.bg=new g(0,0,1e3,400),this.bg.addComponent(new r(this.bg,O,q.BACKGROUND_MEDIUM)),this.addObject(this.bg),this.textBox2=new g(350,210,0,0),this.textBox2.addComponent(new d(this.textBox2,q.OBJECT_MEDIUM,`${Math.floor(dt.getVolume())}`,"35px Comic Sans MS","center","black")),this.addObject(this.textBox2),this.plusBtn=new g(385,175,50,50),this.plusBtn.addComponent(new u(this.plusBtn,q.OBJECT_MEDIUM,"+")),this.addObject(this.plusBtn),this.minusBtn=new g(265,175,50,50),this.minusBtn.addComponent(new u(this.minusBtn,q.OBJECT_MEDIUM,"-")),this.addObject(this.minusBtn),this.exitBtn=new g(250,255,200,50),this.exitBtn.addComponent(new u(this.exitBtn,q.OBJECT_MEDIUM,"Exit")),this.addObject(this.exitBtn)}update(t){const e=this.input.getMouseHoverCoord(),s=e.getX()-this.getCamera().getX(),i=e.getY()-this.getCamera().getY(),n=this.plusBtn.getComponent(u)[0],o=this.minusBtn.getComponent(u)[0],h=this.exitBtn.getComponent(u)[0];if(n.isHovered(s,i),o.isHovered(s,i),h.isHovered(s,i),this.input.isMouseDown()){const t=this.input.getMouseCoord();n.isClicked(t.getX(),t.getY())?dt.setVolume(dt.getVolume()+1):o.isClicked(t.getX(),t.getY())?dt.setVolume(dt.getVolume()-1):h.isClicked(t.getX(),t.getY())&&this.sceneManager.setNextScene("GameStartScene")}else if(this.input.isTouchDown()){const t=this.input.getTouchCoord();n.isClicked(t.getX(),t.getY())||o.isClicked(t.getX(),t.getY())||h.isClicked(t.getX(),t.getY())&&this.sceneManager.setNextScene("GameStartScene"),this.input.resetTouch()}this.textBox2.getComponent(d)[0].setContent(`${Math.floor(dt.getVolume())}`),super.update(t)}}const xt=class extends C{constructor(t,e=0){super(t,"GameStartScene",e),this.tRex=new ut(0,0,100,100,0),this.addObject(this.tRex),this.textBox=new g(350,120,0,0),this.textBox.addComponent(new d(this.textBox,q.OBJECT_MEDIUM,"T-Rex Jump","50px Comic Sans MS","center","#713B61")),this.addObject(this.textBox),this.bg=new g(0,0,700,400),this.bg.addComponent(new r(this.bg,y,q.BACKGROUND_MEDIUM)),this.addObject(this.bg),this.startBtn=new g(250,195,200,50),this.startBtn.addComponent(new u(this.startBtn,q.OBJECT_MEDIUM,"Start")),this.addObject(this.startBtn),this.settingBtn=new g(250,255,200,50),this.settingBtn.addComponent(new u(this.settingBtn,q.OBJECT_MEDIUM,"Setting")),this.addObject(this.settingBtn),this.exitBtn=new g(250,315,200,50),this.exitBtn.addComponent(new u(this.exitBtn,q.OBJECT_MEDIUM,"Exit")),this.addObject(this.exitBtn),this.highScoreText=new g(350,175,200,50),this.highScoreText.addComponent(new d(this.highScoreText,q.OBJECT_LOW,`Highscore: ${M.getHighScore()}`,"30px Comic Sans MS","center","#000000")),this.addObject(this.highScoreText)}update(t){const e=this.input.getMouseHoverCoord(),s=e.getX()-this.getCamera().getX(),i=e.getY()-this.getCamera().getY(),n=this.startBtn.getComponent(u)[0],o=this.settingBtn.getComponent(u)[0],h=this.exitBtn.getComponent(u)[0];if(n.isHovered(s,i),o.isHovered(s,i),h.isHovered(s,i),this.input.isMouseDown()){const t=this.input.getMouseCoord();n.isClicked(t.getX(),t.getY())?this.sceneManager.setNextScene("GamePlayScene"):o.isClicked(t.getX(),t.getY())?this.sceneManager.setNextScene("GameSettingScene"):h.isClicked(t.getX(),t.getY())&&this.sceneManager.setNextScene("GameStartScene")}else if(this.input.isTouchDown()){const t=this.input.getTouchCoord();n.isClicked(t.getX(),t.getY())?this.sceneManager.setNextScene("GamePlayScene"):o.isClicked(t.getX(),t.getY())?this.sceneManager.setNextScene("GameSettingScene"):h.isClicked(t.getX(),t.getY())&&this.sceneManager.setNextScene("GameStartScene"),this.input.resetTouch()}this.highScoreText.getComponent(d)[0].setContent(`Highscore: ${Math.floor(M.getHighScore())}`),super.update(t)}};(new class extends e{constructor(){super(700,400),this.sceneManager=new class{constructor(t){this.scene=t,this.nextSceneName=this.scene.getName()}getScene(){return this.scene}setNewScene(t){this.scene.clear(),this.scene=t,this.nextSceneName=this.scene.getName()}isNeedToChangeScene(){return this.nextSceneName!==this.scene.getName()}setNextScene(t){this.nextSceneName=t}getNextScene(){return this.nextSceneName}}(new xt(this.sceneManager)),this.sceneManager.setNewScene(new xt(this.sceneManager)),s.loadAllImages([X,T,Y,H,E,I,k,j,A,N,G,U,_,J,R,V,W,L,K,P,F,$,x,w,S,b,v,y,D,B,f,O,z])}start(){super.start(),this.update(Date.now())}update(t){let e=Date.now();const i=(e-t)/10;if(s.isLoadComplete()&&(this.sceneManager.getScene().update(i),this.sceneManager.getScene().render(),this.sceneManager.isNeedToChangeScene()))switch(this.sceneManager.getNextScene()){case"GamePlayScene":this.sceneManager.setNewScene(new Ct(this.sceneManager));break;case"GameOverScene":this.sceneManager.setNewScene(new Q(this.sceneManager));break;case"GameStartScene":this.sceneManager.setNewScene(new xt(this.sceneManager));break;case"GameSettingScene":this.sceneManager.setNewScene(new Mt(this.sceneManager))}e=Date.now(),super.update(e)}}).start()})();